# Application configuration
spring.application.name=korven

# DigitalOcean App Platform injects PORT. Keep SERVER_PORT fallback for local/dev.
server.port=${PORT:${SERVER_PORT:8080}}

# -----------------------------
# Database (PostgreSQL)
# Prefer explicit SPRING_DATASOURCE_* env vars in cloud.
# Keep legacy DB_* env vars as fallback for your current setup.
# -----------------------------
spring.datasource.url=${SPRING_DATASOURCE_URL:${DB_URL}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${DB_USERNAME}}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${DB_PASSWORD}}
spring.datasource.driver-class-name=org.postgresql.Driver

# Keep pool below DO managed PG basic limits (22 connections)
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX:10}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN:2}

# -----------------------------
# JPA/Hibernate
# In production you typically want validate (with Liquibase managing schema).
# Default to validate, allow overriding via env.
# -----------------------------
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:validate}
spring.jpa.open-in-view=${JPA_OPEN_IN_VIEW:false}

# Default SQL logging OFF (turn on explicitly in dev via env vars)
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=${JPA_FORMAT_SQL:false}

# -----------------------------
# Liquibase
# -----------------------------
spring.liquibase.enabled=${LIQUIBASE_ENABLED:true}
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml

# -----------------------------
# JWT
# -----------------------------
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration-ms=${JWT_EXPIRATION_MS:3600000}

# -----------------------------
# API Key configuration
# -----------------------------
app.api.key.enabled=${API_KEY_ENABLED:true}

# -----------------------------
# Frontend / Reset password / Mail
# IMPORTANT: don't hardcode production domain if you want staging too.
# Keep your current prod value, but allow override via env.
# -----------------------------
app.frontend-base-url=${APP_FRONTEND_BASE_URL:https://korven.com.ar}
app.mail-from=${APP_MAIL_FROM:no-reply@korven.com.ar}
app.reset-token-ttl-minutes=${RESET_TOKEN_TTL_MINUTES:30}

# -----------------------------
# Mail SMTP
# -----------------------------
spring.mail.host=${SPRING_MAIL_HOST:}
spring.mail.port=${SPRING_MAIL_PORT:587}
spring.mail.username=${SPRING_MAIL_USERNAME:}
spring.mail.password=${SPRING_MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=${SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH:true}
spring.mail.properties.mail.smtp.starttls.enable=${SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE:true}
